/*
 * popcorn.js version c7af492
 * http://popcornjs.org
 *
 * Copyright 2011, Mozilla Foundation
 * Licensed under the MIT license
 */

(function(n,l){function q(a){F.put.call(this,a)}function x(a){this.parent=a;this.byStart=[{start:-1,end:-1}];this.byEnd=[{start:-1,end:-1}];this.animating=[];this.endIndex=this.startIndex=0;this.previousUpdateTime=-1;this.count=1}function G(a,b){return function(){if(c.plugin.debug)return a.apply(this,arguments);try{return a.apply(this,arguments)}catch(e){c.plugin.errors.push({plugin:b,thrown:e,source:a.toString()}),this.emit("pluginerror",c.plugin.errors)}}}if(l.addEventListener){var v=Array.prototype,
z=Object.prototype,A=v.forEach,B=v.slice,t=z.hasOwnProperty,C=z.toString,H=n.Popcorn,y=[],D=!1,u={hash:{},apis:{}},E=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(a,b){n.setTimeout(a,16)}}(),F={put:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}},c=function(a,b){return new c.p.init(a,b||null)};c.version="c7af492";c.isSupported=!0;c.instances=[];c.p=c.prototype={init:function(a,
b){var e=this;if("function"===typeof a)if("complete"===l.readyState)a(l,c);else{if(y.push(a),!D){D=!0;var d=function(){l.removeEventListener("DOMContentLoaded",d,!1);for(var a=0,b=y.length;a<b;a++)y[a].call(l,c);y=null};l.addEventListener("DOMContentLoaded",d,!1)}}else{if("string"===typeof a)try{var g=l.querySelector(a)}catch(f){throw Error("Popcorn.js Error: Invalid media element selector: "+a);}this.media=g||a;a=this.media.nodeName&&this.media.nodeName.toLowerCase()||"video";this[a]=this.media;
this.options=c.extend({},b)||{};this.id=this.options.id||c.guid(a);if(c.byId(this.id))throw Error("Popcorn.js Error: Cannot use duplicate ID ("+this.id+")");this.isDestroyed=!1;this.data={running:{cue:[]},timeUpdate:c.nop,disabled:{},events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:new x(this)};c.instances.push(this);var h=function(){0>e.media.currentTime&&(e.media.currentTime=0);e.media.removeEventListener("loadedmetadata",h,!1);var a,b,d,g;var k=e.media.duration;
k=k!=k?Number.MAX_VALUE:k+1;c.addTrackEvent(e,{start:k,end:k});e.isDestroyed||(e.data.durationChange=function(){var a=e.media.duration,b=a+1,c=e.data.trackEvents.byStart,d=e.data.trackEvents.byEnd;c.pop();d.pop();for(var g=d.length-1;0<g;g--)d[g].end>a&&e.removeTrackEvent(d[g]._id);for(d=0;d<c.length;d++)c[d].end>a&&e.removeTrackEvent(c[d]._id);e.data.trackEvents.byEnd.push({start:b,end:b});e.data.trackEvents.byStart.push({start:b,end:b})},e.media.addEventListener("durationchange",e.data.durationChange,
!1));e.options.frameAnimation?(e.data.timeUpdate=function(){c.timeUpdate(e,{});c.forEach(c.manifest,function(c,f){if(a=e.data.running[f])for(d=a.length,c=0;c<d;c++)b=a[c],(g=b._natives)&&g.frame&&g.frame.call(e,{},b,e.currentTime())});e.emit("timeupdate");!e.isDestroyed&&E(e.data.timeUpdate)},!e.isDestroyed&&E(e.data.timeUpdate)):(e.data.timeUpdate=function(a){c.timeUpdate(e,a)},e.isDestroyed||e.media.addEventListener("timeupdate",e.data.timeUpdate,!1))};e.media.addEventListener("error",function(){e.error=
e.media.error},!1);1<=e.media.readyState?h():e.media.addEventListener("loadedmetadata",h,!1);return this}}};c.p.init.prototype=c.p;c.byId=function(a){for(var b=c.instances,e=b.length,d=0;d<e;d++)if(b[d].id===a)return b[d];return null};c.forEach=function(a,b,c){if(!a||!b)return{};c=c||this;var e;if(A&&a.forEach===A)return a.forEach(b,c);if("[object NodeList]"===C.call(a)){var g=0;for(e=a.length;g<e;g++)b.call(c,a[g],g,a);return a}for(g in a)t.call(a,g)&&b.call(c,a[g],g,a);return a};c.extend=function(a){var b=
a,e=B.call(arguments,1);c.forEach(e,function(a){for(var c in a)b[c]=a[c]});return b};c.extend(c,{noConflict:function(a){a&&(n.Popcorn=H);return c},error:function(a){throw Error(a);},guid:function(a){c.guid.counter++;return(a?a:"")+(+new Date+c.guid.counter)},sizeOf:function(a){var b=0,c;for(c in a)b++;return b},isArray:Array.isArray||function(a){return"[object Array]"===C.call(a)},nop:function(){},position:function(a){if(!a.parentNode)return null;a=a.getBoundingClientRect();var b={},e=l.documentElement,
d=l.body;var g=e.clientTop||d.clientTop||0;var h=e.clientLeft||d.clientLeft||0;var f=n.pageYOffset&&e.scrollTop||d.scrollTop;e=n.pageXOffset&&e.scrollLeft||d.scrollLeft;g=Math.ceil(a.top+f-g);h=Math.ceil(a.left+e-h);for(var r in a)b[r]=Math.round(a[r]);return c.extend({},b,{top:g,left:h})},disable:function(a,b){if(!a.data.disabled[b]){a.data.disabled[b]=!0;if(b in c.registryByName&&a.data.running[b])for(var e=a.data.running[b].length-1,d;0<=e;e--)d=a.data.running[b][e],d._natives.end.call(a,null,
d),a.emit("trackend",c.extend({},d,{plugin:d.type,type:"trackend"}));return a}},enable:function(a,b){if(a.data.disabled[b]){a.data.disabled[b]=!1;if(b in c.registryByName&&a.data.running[b])for(var e=a.data.running[b].length-1,d;0<=e;e--)d=a.data.running[b][e],d._natives.start.call(a,null,d),a.emit("trackstart",c.extend({},d,{plugin:d.type,type:"trackstart",track:d}));return a}},destroy:function(a){var b=a.data.events,e=a.data.trackEvents,d,g,h;for(d in b){var f=b[d];for(g in f)delete f[g];b[d]=null}for(h in c.registryByName)c.removePlugin(a,
h);e.byStart.length=0;e.byEnd.length=0;a.isDestroyed||(a.data.timeUpdate&&a.media.removeEventListener("timeupdate",a.data.timeUpdate,!1),a.isDestroyed=!0);c.instances.splice(c.instances.indexOf(a),1)}});c.guid.counter=1;c.extend(c.p,function(){var a={};c.forEach("load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended".split(/\s+/g),function(b){a[b]=function(a){if("function"===typeof this.media[b])return null!=
a&&/play|pause/.test(b)&&(this.media.currentTime=c.util.toSeconds(a)),this.media[b](),this;if(null!=a){var e=this.media[b];this.media[b]=a;e!==a&&this.emit("attrchange",{attribute:b,previousValue:e,currentValue:a});return this}return this.media[b]}});return a}());c.forEach(["enable","disable"],function(a){c.p[a]=function(b){return c[a](this,b)}});c.extend(c.p,{roundTime:function(){return Math.round(this.media.currentTime)},exec:function(a,b,e){var d=arguments.length,g="trackadded",h;try{var f=c.util.toSeconds(a)}catch(r){}"number"===
typeof f&&(a=f);if("number"===typeof a&&2===d)e=b,b=a,a=c.guid("cue");else if(1===d)b=-1;else if(h=this.getTrackEvent(a))this.data.trackEvents.remove(a),q.end(this,h),c.removeTrackEvent.ref(this,a),g="cuechange","string"===typeof a&&2===d&&("number"===typeof b&&(e=h._natives.start),"function"===typeof b&&(e=b,b=h.start));else if(2<=d){if("string"===typeof b){try{f=c.util.toSeconds(b)}catch(r){}b=f}"number"===typeof b&&(e=e||c.nop());"function"===typeof b&&(e=b,b=-1)}d={id:a,start:b,end:b+1,_running:!1,
_natives:{start:e||c.nop,end:c.nop,type:"cue"}};h&&(d=c.extend(h,d));"cuechange"===g?(d._id=d.id||d._id||c.guid(d._natives.type),this.data.trackEvents.add(d),q.start(this,d),this.timeUpdate(this,null,!0),c.addTrackEvent.ref(this,d),this.emit(g,c.extend({},d,{id:a,type:g,previousValue:{time:h.start,fn:h._natives.start},currentValue:{time:b,fn:e||c.nop},track:h}))):c.addTrackEvent(this,d);return this},mute:function(a){a=null==a||!0===a?"muted":"unmuted";"unmuted"===a&&(this.media.muted=!1,this.media.volume=
this.data.state.volume);"muted"===a&&(this.data.state.volume=this.media.volume,this.media.muted=!0);this.emit(a);return this},unmute:function(a){return this.mute(null==a?!1:!a)},position:function(){return c.position(this.media)},toggle:function(a){return c[this.data.disabled[a]?"enable":"disable"](this,a)},defaults:function(a,b){if(c.isArray(a)){var e=this;a.forEach(function(a){e.defaults(a,b)});return this}this.options.defaults||(this.options.defaults={});this.options.defaults[a]||(this.options.defaults[a]=
{});c.extend(this.options.defaults[a],b);return this}});c.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause error loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"};c.Events.Natives=c.Events.UIEvents+" "+c.Events.MouseEvents+" "+c.Events.Events;
u.apiTypes=["UIEvents","MouseEvents","Events"];(function(a,b){for(var c=u.apiTypes,d=a.Natives.split(/\s+/g),g=0,h=d.length;g<h;g++)b.hash[d[g]]=!0;c.forEach(function(c,e){b.apis[c]={};e=a[c].split(/\s+/g);for(var d=e.length,g=0;g<d;g++)b.apis[c][e[g]]=!0})})(c.Events,u);c.events={isNative:function(a){return!!u.hash[a]},getInterface:function(a){if(!c.events.isNative(a))return!1;for(var b=u.apiTypes,e=u.apis,d=0,g=b.length,h,f;d<g;d++)if(f=b[d],e[f][a]){h=f;break}return h},all:c.Events.Natives.split(/\s+/g),
fn:{trigger:function(a,b){var e,d=this.data.events[a];if(d){if(e=c.events.getInterface(a))return b=l.createEvent(e),b.initEvent(a,!0,!0,n,1),this.media.dispatchEvent(b),this;for(a=d.slice();a.length;)a.shift().call(this,b)}return this},listen:function(a,b){var e=this,d=!0,g=c.events.hooks[a],h;if("function"!==typeof b)throw Error("Popcorn.js Error: Listener is not a function");this.data.events[a]||(this.data.events[a]=[],d=!1);if(g){g.add&&g.add.call(this,{},b);g.bind&&(a=g.bind);if(g.handler){var f=
b;b=function(a){g.handler.call(e,a,f)}}d=!0;this.data.events[a]||(this.data.events[a]=[],d=!1)}this.data.events[a].push(b);!d&&-1<c.events.all.indexOf(a)&&this.media.addEventListener(a,function(b){if(e.data.events[a])for(h=e.data.events[a].slice();h.length;)h.shift().call(e,b)},!1);return this},unlisten:function(a,b){var c=this.data.events[a];if(c){if("string"===typeof b){for(a=0;a<c.length;a++)c[a].name===b&&c.splice(a--,1);return this}if("function"===typeof b){for(;-1!==d;){var d=c.indexOf(b);-1!==
d&&c.splice(d,1)}return this}this.data.events[a]=null;return this}}},hooks:{canplayall:{bind:"canplaythrough",add:function(a,b){var c=!1;this.media.readyState&&(setTimeout(function(){b.call(this,a)}.bind(this),0),c=!0);this.data.hooks.canplayall={fired:c}},handler:function(a,b){this.data.hooks.canplayall.fired||(b.call(this,a),this.data.hooks.canplayall.fired=!0)}}}};c.forEach([["trigger","emit"],["listen","on"],["unlisten","off"]],function(a){c.p[a[0]]=c.p[a[1]]=c.events.fn[a[0]]});q.start=function(a,
b){b.end>a.media.currentTime&&b.start<=a.media.currentTime&&!b._running&&(b._running=!0,a.data.running[b._natives.type].push(b),a.data.disabled[b._natives.type]||(b._natives.start.call(a,null,b),a.emit("trackstart",c.extend({},b,{plugin:b._natives.type,type:"trackstart",track:b}))))};q.end=function(a,b){if((b.end<=a.media.currentTime||b.start>a.media.currentTime)&&b._running){var e=a.data.running[b._natives.type];b._running=!1;e.splice(e.indexOf(b),1);a.data.disabled[b._natives.type]||(b._natives.end.call(a,
null,b),a.emit("trackend",c.extend({},b,{plugin:b._natives.type,type:"trackend",track:b})))}};x.prototype.where=function(a){return(this.parent.getTrackEvents()||[]).filter(function(b){var c;if(!a)return!0;for(c in a){var d=a[c];var g;(g=b[c]&&b[c]===d)||(g=b._natives,g=g[c]&&g[c]===d);if(g)return!0}return!1})};x.prototype.add=function(a){var b=this.byStart,e=this.byEnd,d;a&&a._id&&this.parent.data.history.push(a._id);a.start=c.util.toSeconds(a.start,this.parent.options.framerate);a.end=c.util.toSeconds(a.end,
this.parent.options.framerate);for(d=b.length-1;0<=d;d--)if(a.start>=b[d].start){b.splice(d+1,0,a);break}for(b=e.length-1;0<=b;b--)if(a.end>e[b].end){e.splice(b+1,0,a);break}d<=this.parent.data.trackEvents.startIndex&&a.start<=this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.startIndex++;b<=this.parent.data.trackEvents.endIndex&&a.end<this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.endIndex++;this.count++};x.prototype.remove=function(a,b){a instanceof
q&&(a=a.id);if("object"===typeof a)return this.where(a).forEach(function(a){this.removeTrackEvent(a._id)},this.parent),this;var c=this.byStart.length;var d=0,g=0,h=[],f=[],r=[];for(b=[];-1<--c;){var p=this.byStart[d];var l=this.byEnd[d];p._id||(h.push(p),f.push(l));p._id&&(p._id!==a&&h.push(p),l._id!==a&&f.push(l),p._id===a&&(g=d));d++}c=this.animating.length;d=0;if(c)for(;-1<--c;)p=this.animating[d],p._id||r.push(p),p._id&&p._id!==a&&r.push(p),d++;g<=this.startIndex&&this.startIndex--;g<=this.endIndex&&
this.endIndex--;this.byStart=h;this.byEnd=f;this.animating=r;this.count--;c=this.parent.data.history.length;for(d=0;d<c;d++)this.parent.data.history[d]!==a&&b.push(this.parent.data.history[d]);this.parent.data.history=b};c.addTrackEvent=function(a,b){if(!(b instanceof q)){if((b=new q(b),b._natives)&&b._natives.type&&a.options.defaults&&a.options.defaults[b._natives.type]){var e=c.extend({},b);c.extend(b,a.options.defaults[b._natives.type],e)}b._natives&&(b._id=b.id||b._id||c.guid(b._natives.type),
b._natives._setup&&(b._natives._setup.call(a,b),a.emit("tracksetup",c.extend({},b,{plugin:b._natives.type,type:"tracksetup",track:b}))));a.data.trackEvents.add(b);q.start(a,b);this.timeUpdate(a,null,!0);b._id&&c.addTrackEvent.ref(a,b);a.emit("trackadded",c.extend({},b,b._natives?{plugin:b._natives.type}:{},{type:"trackadded",track:b}))}};c.addTrackEvent.ref=function(a,b){a.data.trackRefs[b._id]=b;return a};c.removeTrackEvent=function(a,b){var e=a.getTrackEvent(b);e&&(e._natives._teardown&&e._natives._teardown.call(a,
e),a.data.trackEvents.remove(b),c.removeTrackEvent.ref(a,b),e._natives&&a.emit("trackremoved",c.extend({},e,{plugin:e._natives.type,type:"trackremoved",track:e})))};c.removeTrackEvent.ref=function(a,b){delete a.data.trackRefs[b];return a};c.getTrackEvents=function(a){var b=[];a=a.data.trackEvents.byStart;for(var c=a.length,d=0,g;d<c;d++)g=a[d],g._id&&b.push(g);return b};c.getTrackEvents.ref=function(a){return a.data.trackRefs};c.getTrackEvent=function(a,b){return a.data.trackRefs[b]};c.getTrackEvent.ref=
function(a,b){return a.data.trackRefs[b]};c.getLastTrackEventId=function(a){return a.data.history[a.data.history.length-1]};c.timeUpdate=function(a,b){var e=a.media.currentTime,d=a.data.trackEvents.previousUpdateTime,g=a.data.trackEvents,h=g.endIndex,f=g.startIndex,l=g.byStart.length,p=g.byEnd.length,n=c.registryByName;if(d<=e){for(;g.byEnd[h]&&g.byEnd[h].end<=e;){var k=g.byEnd[h];var m=(d=k._natives)&&d.type;if(!d||n[m]||a[m]){if(!0===k._running){k._running=!1;var w=a.data.running[m];w.splice(w.indexOf(k),
1);a.data.disabled[m]||(d.end.call(a,b,k),a.emit("trackend",c.extend({},k,{plugin:m,type:"trackend",track:k})))}h++}else{c.removeTrackEvent(a,k._id);return}}for(;g.byStart[f]&&g.byStart[f].start<=e;)if(k=g.byStart[f],m=(d=k._natives)&&d.type,!d||n[m]||a[m])k.end>e&&!1===k._running&&(k._running=!0,a.data.running[m].push(k),a.data.disabled[m]||(d.start.call(a,b,k),a.emit("trackstart",c.extend({},k,{plugin:m,type:"trackstart",track:k})))),f++;else{c.removeTrackEvent(a,k._id);return}}else if(d>e){for(;g.byStart[f]&&
g.byStart[f].start>e;)if(k=g.byStart[f],m=(d=k._natives)&&d.type,!d||n[m]||a[m])!0===k._running&&(k._running=!1,w=a.data.running[m],w.splice(w.indexOf(k),1),a.data.disabled[m]||(d.end.call(a,b,k),a.emit("trackend",c.extend({},k,{plugin:m,type:"trackend",track:k})))),f--;else{c.removeTrackEvent(a,k._id);return}for(;g.byEnd[h]&&g.byEnd[h].end>e;)if(k=g.byEnd[h],m=(d=k._natives)&&d.type,!d||n[m]||a[m])k.start<=e&&!1===k._running&&(k._running=!0,a.data.running[m].push(k),a.data.disabled[m]||(d.start.call(a,
b,k),a.emit("trackstart",c.extend({},k,{plugin:m,type:"trackstart",track:k})))),h--;else{c.removeTrackEvent(a,k._id);return}}g.endIndex=h;g.startIndex=f;g.previousUpdateTime=e;g.byStart.length<l&&g.startIndex--;g.byEnd.length<p&&g.endIndex--};c.extend(c.p,{getTrackEvents:function(){return c.getTrackEvents.call(null,this)},getTrackEvent:function(a){return c.getTrackEvent.call(null,this,a)},getLastTrackEventId:function(){return c.getLastTrackEventId.call(null,this)},removeTrackEvent:function(a){c.removeTrackEvent.call(null,
this,a);return this},removePlugin:function(a){c.removePlugin.call(null,this,a);return this},timeUpdate:function(a){c.timeUpdate.call(null,this,a);return this},destroy:function(){c.destroy.call(null,this);return this}});c.manifest={};c.registry=[];c.registryByName={};c.plugin=function(a,b,e){if(0<=c.protect.natives.indexOf(a.toLowerCase()))c.error("'"+a+"' is a protected function name");else{var d="function"===typeof b,g=["start","end","type","manifest"],h=["_setup","_teardown","start","end","frame"],
f={},l=function(a,b){a=a||c.nop;b=b||c.nop;return function(){a.apply(this,arguments);b.apply(this,arguments)}};c.manifest[a]=e=e||b.manifest||{};h.forEach(function(e){b[e]=G(b[e]||c.nop,a)});var p=function(b,d){if(!d)return this;if(d.ranges&&c.isArray(d.ranges))return c.forEach(d.ranges,function(b){b=c.extend({},d,b);delete b.ranges;this[a](b)},this),this;var f=d._natives={},k="";c.extend(f,b);d._natives.type=d._natives.plugin=a;d._running=!1;f.start=f.start||f["in"];f.end=f.end||f.out;d.once&&(f.end=
l(f.end,function(){this.removeTrackEvent(d._id)}));f._teardown=l(function(){var a=B.call(arguments),b=this.data.running[f.type];a.unshift(null);a[1]._running&&b.splice(b.indexOf(d),1)&&f.end.apply(this,a);a[1]._running=!1;this.emit("trackend",c.extend({},d,{plugin:f.type,type:"trackend",track:c.getTrackEvent(this,d.id||d._id)}))},f._teardown);f._teardown=l(f._teardown,function(){this.emit("trackteardown",c.extend({},d,{plugin:a,type:"trackteardown",track:c.getTrackEvent(this,d.id||d._id)}))});d.compose=
d.compose||[];"string"===typeof d.compose&&(d.compose=d.compose.split(" "));d.effect=d.effect||[];"string"===typeof d.effect&&(d.effect=d.effect.split(" "));d.compose=d.compose.concat(d.effect);d.compose.forEach(function(a){k=c.compositions[a]||{};h.forEach(function(a){f[a]=l(f[a],k[a])})});d._natives.manifest=e;"start"in d||(d.start=d["in"]||0);d.end||0===d.end||(d.end=d.out||Number.MAX_VALUE);t.call(d,"toString")||(d.toString=function(){var b=["start: "+d.start,"end: "+d.end,"id: "+(d.id||d._id)];
null!=d.target&&b.push("target: "+d.target);return a+" ( "+b.join(", ")+" )"});if(!d.target){var m="options"in e&&e.options;d.target=m&&"target"in m&&m.target}!d._id&&d._natives&&(d._id=c.guid(d._natives.type));d instanceof q?(d._natives&&(d._id=d.id||d._id||c.guid(d._natives.type),d._natives._setup&&(d._natives._setup.call(this,d),this.emit("tracksetup",c.extend({},d,{plugin:d._natives.type,type:"tracksetup",track:d})))),this.data.trackEvents.add(d),q.start(this,d),this.timeUpdate(this,null,!0),
d._id&&c.addTrackEvent.ref(this,d)):c.addTrackEvent(this,d);c.forEach(b,function(a,b){if(-1===g.indexOf(b))this.on(b,a)},this);return this};c.p[a]=f[a]=function(e,g){var f;if(e&&!g)g=e;else{if(f=this.getTrackEvent(e)){var h=g;var k={},l;for(l in f)t.call(h,l)&&t.call(f,l)&&(k[l]=f[l]);if(f._natives._update)this.data.trackEvents.remove(f),t.call(g,"start")&&(f.start=g.start),t.call(g,"end")&&(f.end=g.end),q.end(this,f),d&&b.call(this,f),f._natives._update.call(this,f,g),this.data.trackEvents.add(f),
q.start(this,f);else return c.extend(f,g),this.data.trackEvents.remove(e),f._natives._teardown&&f._natives._teardown.call(this,f),c.removeTrackEvent.ref(this,e),d?p.call(this,b.call(this,f),f):(f._id=f.id||f._id||c.guid(f._natives.type),f._natives&&f._natives._setup&&(f._natives._setup.call(this,f),this.emit("tracksetup",c.extend({},f,{plugin:f._natives.type,type:"tracksetup",track:f}))),this.data.trackEvents.add(f),q.start(this,f),this.timeUpdate(this,null,!0),c.addTrackEvent.ref(this,f)),this.emit("trackchange",
{id:f.id,type:"trackchange",previousValue:k,currentValue:f,track:f}),this;"cue"!==f._natives.type&&this.emit("trackchange",{id:f.id,type:"trackchange",previousValue:k,currentValue:h,track:f});return this}g.id=e}this.data.running[a]=this.data.running[a]||[];e=c.extend({},this.options.defaults&&this.options.defaults[a]||{},g);p.call(this,d?b.call(this,e):b,e);return this};e&&c.extend(b,{manifest:e});var n={fn:f[a],definition:b,base:b,parents:[],name:a};c.registry.push(c.extend(f,n,{type:a}));c.registryByName[a]=
n;return f}};c.plugin.errors=[];c.plugin.debug="c7af492"===c.version;c.removePlugin=function(a,b){if(!b){b=a;a=c.p;if(0<=c.protect.natives.indexOf(b.toLowerCase())){c.error("'"+b+"' is a protected function name");return}var e=c.registry.length,d;for(d=0;d<e;d++)if(c.registry[d].name===b){c.registry.splice(d,1);delete c.registryByName[b];delete c.manifest[b];delete a[b];return}}e=a.data.trackEvents.byStart;d=a.data.trackEvents.byEnd;var g=a.data.trackEvents.animating,h;var f=0;for(h=e.length;f<h;f++)e[f]&&
e[f]._natives&&e[f]._natives.type===b&&(e[f]._natives._teardown&&e[f]._natives._teardown.call(a,e[f]),e.splice(f,1),f--,h--,a.data.trackEvents.startIndex<=f&&(a.data.trackEvents.startIndex--,a.data.trackEvents.endIndex--)),d[f]&&d[f]._natives&&d[f]._natives.type===b&&d.splice(f,1);f=0;for(h=g.length;f<h;f++)g[f]&&g[f]._natives&&g[f]._natives.type===b&&(g.splice(f,1),f--,h--)};c.compositions={};c.compose=function(a,b,e){c.manifest[a]=e||b.manifest||{};c.compositions[a]=b};c.plugin.effect=c.effect=
c.compose;var I=/^(?:\.|#|\[)/;c.dom={debug:!1,find:function(a,b){var e=null;b=b||l;if(a){if(!I.test(a)&&(e=l.getElementById(a),null!==e))return e;try{e=b.querySelector(a)}catch(d){if(c.dom.debug)throw Error(d);}}return e}};var J=/\?/,K={ajax:null,url:"",data:"",dataType:"",success:c.nop,type:"GET",async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8"};c.xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;if(!a.dataType||"jsonp"!==a.dataType&&"script"!==a.dataType){if(a=
c.extend({},K,a),a.ajax=new XMLHttpRequest,a.ajax)return"GET"===a.type&&a.data&&(a.url+=(J.test(a.url)?"&":"?")+a.data,a.data=null),a.ajax.open(a.type,a.url,a.async),"POST"===a.type&&a.ajax.setRequestHeader("Content-Type",a.contentType),a.ajax.send(a.data||null),c.xhr.httpData(a)}else c.xhr.getJSONP(a.url,a.success,"script"===a.dataType)};c.xhr.httpData=function(a){var b,c=null,d,g=null;a.ajax.onreadystatechange=function(){if(4===a.ajax.readyState){try{c=JSON.parse(a.ajax.responseText)}catch(h){}b=
{xml:a.ajax.responseXML,text:a.ajax.responseText,json:c};if(!b.xml||!b.xml.documentElement){b.xml=null;try{d=new DOMParser,g=d.parseFromString(a.ajax.responseText,"text/xml"),g.getElementsByTagName("parsererror").length||(b.xml=g)}catch(h){}}a.dataType&&(b=b[a.dataType]);a.success.call(a.ajax,b)}};return b};c.xhr.getJSONP=function(a,b,e){var d=l.head||l.getElementsByTagName("head")[0]||l.documentElement,g=l.createElement("script"),h=!1,f=[];f=/(=)\?(?=&|$)|\?\?/;if(!e){var n=a.match(/(callback=[^&]*)/);
if(null!==n&&n.length){f=n[1].split("=")[1];"?"===f&&(f="jsonp");var p=c.guid(f);a=a.replace(/(callback=[^&]*)/,"callback="+p)}else p=c.guid("jsonp"),f.test(a)&&(a=a.replace(f,"$1"+p)),f=a.split(/\?(.+)?/),a=f[0]+"?",f[1]&&(a+=f[1]+"&"),a+="callback="+p;window[p]=function(a){b&&b(a);h=!0}}g.addEventListener("load",function(){e&&b&&b();h&&delete window[p];d.removeChild(g)},!1);g.addEventListener("error",function(a){b&&b({error:a});e||delete window[p];d.removeChild(g)},!1);g.src=a;d.insertBefore(g,
d.firstChild)};c.getJSONP=c.xhr.getJSONP;c.getScript=c.xhr.getScript=function(a,b){return c.xhr.getJSONP(a,b,!0)};c.util={toSeconds:function(a,b){var e=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/;if("number"===typeof a)return a;"string"!==typeof a||e.test(a)||c.error("Invalid time format");a=a.split(":");e=a.length-1;var d=a[e];if(-1<d.indexOf(";")){d=d.split(";");var g=0;b&&"number"===typeof b&&(g=parseFloat(d[1],10)/b);a[e]=parseInt(d[0],10)+g}b=a[0];return{1:parseFloat(b,10),2:60*parseInt(b,10)+parseFloat(a[1],
10),3:3600*parseInt(b,10)+60*parseInt(a[1],10)+parseFloat(a[2],10)}[a.length||1]}};c.p.cue=c.p.exec;c.protect={natives:function(a){if(Object.keys)a=Object.keys(a);else{var b,c=[];for(b in a)t.call(a,b)&&c.push(b);a=c}return a}(c.p).map(function(a){return a.toLowerCase()})};c.forEach({listen:"on",unlisten:"off",trigger:"emit",exec:"cue"},function(a,b){var e=c.p[b];c.p[b]=function(){"undefined"!==typeof console&&console.warn&&(console.warn("Deprecated method '"+b+"', "+(null==a?"do not use.":"use '"+
a+"' instead.")),c.p[b]=e);return c.p[a].apply(this,[].slice.call(arguments))}});n.Popcorn=c}else for(n.Popcorn={isSupported:!1},v="byId forEach extend effects error guid sizeOf isArray nop position disable enable destroyaddTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect xhr getJSONP getScript".split(/\s+/);v.length;)n.Popcorn[v.shift()]=function(){}})(window,window.document);
